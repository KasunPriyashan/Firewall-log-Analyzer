# Firewall-log-Analyzer
Firewall Log Analyzer: Your Key to Enhanced Network Security. In an era of evolving cyber threats, the Firewall Log Analyzer is your vigilant sentry, decoding firewall logs to detect threats, understand traffic patterns, and fortify your network's defenses.

Methodology for create Log analyzer
In order to write a script for ABC Inc. that does simple analysis of firewall logs, we need to take into consideration the following steps:
•	The format of the log needs to be understood. The firewall logs generated by iptables on Linux and those generated by AWS security groups have different forms. To extract useful data, it is essential to have a working knowledge of these formats.
•	The process of extracting the pertinent information from these logs and preparing it in preparation for analysis is referred to as data extraction and preprocessing.
•	Analysis and Pattern Detection: Examining these logs in order to locate potential dangers and irregularities, as well as to gain an understanding of traffic patterns.

The provided log file appears to be structured with a clear header line, followed by individual log entries. Each entry contains several fields, as outlined in the header:

•	Date and Time: The date and time of the logged event.
•	Action: The action taken by the firewall (e.g., ALLOW, BLOCK).
•	Protocol: The network protocol used (e.g., TCP, UDP, ICMP).
•	Src IP: Source IP address.
•	Dst IP: Destination IP address.
•	Src Port: Source port number.
•	Dst Port: Destination port number.
•	Size: Size of the packet.
•	TCP Flags: TCP flags, if applicable.
•	Info: Additional information about the event (e.g., type of request, nature of traffic).

Based on this structure, the script can process these logs to:

Categorize Traffic: Classify traffic based on action (ALLOW, BLOCK), protocol, and other attributes.
Identify Anomalies: Look for unusual patterns, such as repeated blocks from the same source IP or unusual traffic on sensitive ports.
Traffic Analysis: Determine the most common types of traffic, frequent sources of blocked traffic, etc.
Security Incidents Identification: Flag potential security incidents like repeated SSH or SQL Server access attempts from external sources.



Design

I created a simple python script for analyze firewall logs using flask environment .for creation I used following steps.

1.	Importing Libraries:
The code starts by importing necessary libraries, including Flask, os, pandas (for data manipulation), and re (for regular expressions).

2.	Configuration:
It defines some configuration settings for the Flask application, including the location where uploaded log files will be stored temporarily (UPLOAD_FOLDER) and a set of allowed file extensions (ALLOWED_EXTENSIONS).

3.	Creating a Flask App:
The Flask application is created using Flask(__name__).

4.	Parsing Log Lines:
The code defines a function parse_log_line(line) to parse a single line of a log file. It uses regular expressions to split each line into fields and extracts relevant information such as date, time, action, protocol, source and destination IP addresses, ports, size, TCP flags, and additional information.
5.	Analyzing Uploaded Log File:

Another function analyze_uploaded_log(file) is defined to analyze the uploaded log file. It reads the log file, skips the header line, and iterates through the lines to parse and extract data.
The extracted log data is then converted into a Pandas DataFrame for further analysis.
Basic log analysis is performed, including counting actions, identifying top blocked ports, and finding suspicious source IPs.
Several custom functions are defined within this function to identify potential threats such as DDoS attempts, brute force attacks, port scanning, horizontal scanning, uncommon port traffic, repeated actions, unauthorized SSH access attempts, and SQL Server access attempts.
These threat identification functions return relevant information based on predefined criteria and thresholds.

6.	Checking Allowed File Extension:

A function allowed_file(filename) checks if the uploaded file has a valid log file extension (in this case, '.log').

7.	Uploading Log File:
The main route '/' is defined for the web application. It handles both GET and POST requests.
When a POST request is made (usually after uploading a log file), it checks if a file was uploaded, validates the file extension, and saves the uploaded file to the specified UPLOAD_FOLDER.
It then calls the analyze_uploaded_log function to perform log file analysis.
Finally, it renders a results template with the analyzed data and presents it to the user.


